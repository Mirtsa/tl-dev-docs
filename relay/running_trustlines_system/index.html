<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.69">
<title data-react-helmet="true">Running the Trustlines system | Trustlines Developer Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-relay-current"><meta data-react-helmet="true" property="og:title" content="Running the Trustlines system | Trustlines Developer Docs"><meta data-react-helmet="true" name="description" content="This document explains how to run your own trustlines network relay server infrastructure. We will walk you through setting up a relay server and all dependent components. The current documentation is written for a Debian-based Linux system."><meta data-react-helmet="true" property="og:description" content="This document explains how to run your own trustlines network relay server infrastructure. We will walk you through setting up a relay server and all dependent components. The current documentation is written for a Debian-based Linux system."><meta data-react-helmet="true" property="og:url" content="https://dev.trustlines.network/relay/running_trustlines_system"><link data-react-helmet="true" rel="shortcut icon" href="/img/tl-favicon.png"><link data-react-helmet="true" rel="canonical" href="https://dev.trustlines.network/relay/running_trustlines_system"><link rel="stylesheet" href="/styles.70b48e6c.css">
<link rel="preload" href="/styles.d7518ca5.js" as="script">
<link rel="preload" href="/runtime~main.7eef94f8.js" as="script">
<link rel="preload" href="/main.920ea549.js" as="script">
<link rel="preload" href="/1.177b00bb.js" as="script">
<link rel="preload" href="/1be78505.ca2dbdcf.js" as="script">
<link rel="preload" href="/c4f5d8e4.a0e57ad6.js" as="script">
<link rel="preload" href="/346.f122d46c.js" as="script">
<link rel="preload" href="/345.7b55013b.js" as="script">
<link rel="preload" href="/ef0253de.b8f63b97.js" as="script">
<link rel="preload" href="/344.0455ebad.js" as="script">
<link rel="preload" href="/c75c3418.d91fb2fc.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/tl-favicon.png" alt="Trustlines logo"><strong class="navbar__title">Trustlines Dev Docs</strong></a><a class="navbar__item navbar__link" href="/blockchain/tlbc">Blockchain</a><a class="navbar__item navbar__link" href="/contracts/contracts_README">Contracts</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/relay/relay_server">Relay</a><a class="navbar__item navbar__link" href="/clientlib/clientlib/">Clientlib</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/trustlines-protocol/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/tl-favicon.png" alt="Trustlines logo"><strong class="navbar__title">Trustlines Dev Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/blockchain/tlbc">Blockchain</a></li><li class="menu__list-item"><a class="menu__link" href="/contracts/contracts_README">Contracts</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/relay/relay_server">Relay</a></li><li class="menu__list-item"><a class="menu__link" href="/clientlib/clientlib/">Clientlib</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/relay/relay_server">Trustlines relay server</a></li><li class="menu__list-item"><a class="menu__link" href="/relay/relay-api">Trustlines Relay API</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/relay/running_trustlines_system">Running the Trustlines system</a></li><li class="menu__list-item"><a class="menu__link" href="/relay/trustlines_docker">Running Trustlines via docker-compose</a></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Running the Trustlines system</h1></header><div class="markdown"><blockquote><p>This document explains how to run your own <a href="https://trustlines.network/" target="_blank" rel="noopener noreferrer">trustlines network</a> relay server infrastructure. We will walk you through setting up a relay server and all dependent components. The current documentation is written for a Debian-based Linux system.</p></blockquote><p>If you are low on time, you may jump to the description of the <a href="/relay/trustlines_docker">docker-compose based setup</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dependencies"></a>Dependencies<a class="hash-link" href="#dependencies" title="Direct link to heading">#</a></h2><p>Since the trustlines infrastructure components are implemented in python 3, you need to install relevant dependencies. You will need at least python 3.6.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> build-essential python3-dev python3-venv pkg-config </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     libssl-dev automake autoconf libtool </span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> libpq-dev</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The installation instructions assume you create a dedicated user account and put
files directly into the user&#x27;s home directory. Else, adapt the paths to your needs!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="trustlines-blockchain"></a>Trustlines Blockchain<a class="hash-link" href="#trustlines-blockchain" title="Direct link to heading">#</a></h3><p>You need to run our modified parity node, which provides the JSONRPC API to the relay
server and the indexer. The documentation on how to run it can be found on the
<a href="/blockchain/tlbc">Blockchain Overview page</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="contracts"></a>Contracts<a class="hash-link" href="#contracts" title="Direct link to heading">#</a></h3><p>The <a href="https://github.com/trustlines-protocol/contracts" target="_blank" rel="noopener noreferrer">trustlines-contracts
repository</a> contains the
solidity contracts to be deployed on the blockchain and a commandline tool to deploy the contracts. The <a href="/contracts/contracts_deployment">how to deploy the
contracts guide</a> contains more information on how to deploy the contracts.
The tool will return the addresses of the deployed contracts. You need to provide that information to the relay server with as json file <code>addresses.json</code> with the following format:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-json codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;networks&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">&lt;list of currency network addresses&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;unwEth&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> &lt;address of unw_eth_contract&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;exchange&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> &lt;address of exchange&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>For the already deployed contracts on the trustlines blockchain use this file:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-json codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;networks&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x9750bdB86B32DCaeFEAea4f29857D52C8d848860&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0xe4D3cEB3d59B6Fa4a39C8D9525c84C79057C1e29&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0xd75C9C8a79D6a85d4923b7C16BAb144cC9BB48e4&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>We assume from now on that the contracts have already been deployed
and that the <code>addresses.json</code> file has been copied to the user&#x27;s home directory.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="postgresql"></a>PostgreSQL<a class="hash-link" href="#postgresql" title="Direct link to heading">#</a></h3><p>The trustlines system uses a PostgreSQL database to store some user data and to
keep a synchronized view on the relevant state from the blockchain.</p><p>Install PostgreSQL with:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> postgresql</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After this, a database user must be created. Please use a real password:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> -u postgres psql </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">CREATE USER trustlines WITH PASSWORD &#x27;choose-a-password-here&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ALTER USER trustlines CREATEDB;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Next, the postgres environment should be configured for the account running
the relay server:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain">~/.pgpass </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;localhost:5432:*:trustlines:choose-a-password-here&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> 0600 ~/.pgpass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain">~/.bashrc </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">export PGUSER=trustlines</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">export PGHOST=localhost</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">export PGDATABASE=trustlinesdb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After logging in again, in order to have the environment variables set, the user
should be able to create the database:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-sql codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">createdb trustlinesdb</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The rest of this tutorial assumes that the user running the relay and
py-eth-index related commands has a working postgresql environment configured.
All programs consider the PG* environment variables and will read ~/.pgpass for
information about passwords. The <a href="#py-eth-index">py-eth-index section</a> describes
how to create the trustlines specific tables.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="py-eth-index"></a>Py-eth-index<a class="hash-link" href="#py-eth-index" title="Direct link to heading">#</a></h3><p>The <a href="https://github.com/trustlines-protocol/py-eth-index" target="_blank" rel="noopener noreferrer">py-eth-index repository</a>
contains a helper program that synchronizes the relevant information from the
blockchain into a postgresql database.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="installation-of-py-eth-index"></a>Installation of py-eth-index<a class="hash-link" href="#installation-of-py-eth-index" title="Direct link to heading">#</a></h4><p>Clone the git repository:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> clone https://github.com/trustlines-protocol/py-eth-index</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Letâ€™s create a virtualenv for this repository:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">python3 -m venv ~/opt/py-eth-index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> ~/opt/py-eth-index/bin/pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -U pip</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>and install py-eth-index</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> ~/py-eth-index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/py-eth-index/bin/pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -c constraints.txt -r requirements.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/py-eth-index/bin/pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -c constraints.txt </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="initializing-the-database"></a>Initializing the database<a class="hash-link" href="#initializing-the-database" title="Direct link to heading">#</a></h4><p>After the database has been created, it must be initialized. This can be done with the following command:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/py-eth-index/bin/ethindex createtables</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="importing-the-abis"></a>Importing the ABIs<a class="hash-link" href="#importing-the-abis" title="Direct link to heading">#</a></h4><p>We need to import the ABIs from the trustline-contracts. Trustlines-contracts is
installed as a dependency of the relay server. Please run the following only
after you have installed the relay server.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> ~/opt/relay/trustlines-contracts/build/contracts.json ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/py-eth-index/bin/ethindex importabi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="importing-events"></a>Importing events<a class="hash-link" href="#importing-events" title="Direct link to heading">#</a></h4><p>The following command will start importing all relevant events into the postgres
database:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/py-eth-index/bin/ethindex runsync</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>This program will run forever.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="relay-server"></a>Relay server<a class="hash-link" href="#relay-server" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="prerequisites-for-the-installation"></a>Prerequisites for the installation<a class="hash-link" href="#prerequisites-for-the-installation" title="Direct link to heading">#</a></h4><ul><li>Python 3.6 or up</li><li>pip</li></ul><p>Installation on Ubuntu</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> build-essential python3-dev libsecp256k1-dev python3-virtualenv virtualenv pkg-config libssl-dev automake autoconf libtool </span><span class="token function" style="color:rgb(130, 170, 255)">git</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="installation-of-the-relay-server"></a>Installation of the relay server<a class="hash-link" href="#installation-of-the-relay-server" title="Direct link to heading">#</a></h4><p>Clone the git repository, create a virtualenv and install into
that.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> clone https://github.com/trustlines-protocol/relay</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">python3 -m venv ~/opt/relay</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> ~/opt/relay/bin/pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -U pip</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> ~/relay</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/relay/bin/pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -c constraints.txt -r requirements.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/relay/bin/pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -c constraints.txt </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="running-the-relay-server"></a>Running the relay server<a class="hash-link" href="#running-the-relay-server" title="Direct link to heading">#</a></h4><p>The relay server needs the addresses of the deployed contracts. In case you&#x27;ve
deployed your own contracts, please copy addresses.json to <code>~</code>.</p><p>We will also need a config file. You can use the one from the git checkout:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> ~/relay/config.toml ~</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The relay server reads both files from the current directory per default,
so we need to start it where those files have been copied to:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/relay/bin/tl-relay</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>However, this behaviour can be changed, you can check the options with:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/relay/bin/tl-relay --help</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The relay server needs access to the parity node and the PostgreSQL database.
<code>ethindex runsync</code> also has to be running for a fully functioning system.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/trustlines-protocol/tl-dev-docs/edit/master/relay/running_trustlines_system.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/relay/relay-api"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Trustlines Relay API</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/relay/trustlines_docker"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Running Trustlines via docker-compose Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dependencies" class="table-of-contents__link">Dependencies</a><ul><li><a href="#trustlines-blockchain" class="table-of-contents__link">Trustlines Blockchain</a></li><li><a href="#contracts" class="table-of-contents__link">Contracts</a></li><li><a href="#postgresql" class="table-of-contents__link">PostgreSQL</a></li><li><a href="#py-eth-index" class="table-of-contents__link">Py-eth-index</a></li><li><a href="#relay-server" class="table-of-contents__link">Relay server</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Websites</h4><ul class="footer__items"><li class="footer__item"><a href="https://blog.trustlines.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Blog</a></li><li class="footer__item"><a href="https://trustlines.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Foundation</a></li><li class="footer__item"><a href="https://docs.trustlines.network//" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines User Docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://forum.trustlines.network/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Forum</a></li><li class="footer__item"><a href="http://eepurl.com/gHqYyX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Newsletter</a></li><li class="footer__item"><a href="https://t.me/trustlines_network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Network in Telegram</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/trustlines-protocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines on github</a></li><li class="footer__item"><a href="https://gitter.im/trustlines/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Technical Chat</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Trustlines.</div></div></div></footer></div>
<script src="/styles.d7518ca5.js"></script>
<script src="/runtime~main.7eef94f8.js"></script>
<script src="/main.920ea549.js"></script>
<script src="/1.177b00bb.js"></script>
<script src="/1be78505.ca2dbdcf.js"></script>
<script src="/c4f5d8e4.a0e57ad6.js"></script>
<script src="/346.f122d46c.js"></script>
<script src="/345.7b55013b.js"></script>
<script src="/ef0253de.b8f63b97.js"></script>
<script src="/344.0455ebad.js"></script>
<script src="/c75c3418.d91fb2fc.js"></script>
</body>
</html>